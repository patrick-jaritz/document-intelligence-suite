-- Test with the ACTUAL embedding string from the Edge Function logs
-- Copy the embedding from: "Calling RPC with params: {"query_embedding":"[...]"
-- and paste it below

SELECT 
  chunk_index,
  ROUND(similarity::numeric, 4) as similarity,
  substring(chunk_text, 1, 150) as preview
FROM match_document_chunks(
  '[-0.019892618,0.003907722,-0.05552505,0.02155374,-0.041010655,0.008836625,-0.031261776,0.022084756,0.019282322,0.006901015,-0.0019152442,-0.0015752903,0.033301875,-0.050618675,0.020978985,-0.022897612,-0.017387768,0.0012916024,0.011877766,-0.025922934,0.024024058,0.008063768,0.0052301935,-0.030042671,-0.010352161,-0.0028544608,0.0053114076,-0.021101339,0.021751303,-0.026694147,-0.0071476307,-0.011951408,0.02038765,0.0071597397,0.010467432,0.033626065,0.008049948,-0.009134305,0.0018949118,-0.02194774,0.020776775,0.021345677,-0.03062874,0.018851327,-0.013296835,-0.0034524752,0.016960325,-0.025597295,0.011383091,-0.015780527,-0.012337221,0.028186707,-0.02084502,-0.012453399,-0.03189009,-0.012121668,-0.00027476466,0.0031867346,0.0018073595,0.016920915,0.008823162,-0.027933568,-0.0021363907,-0.0052837897,0.0063991472,-0.011396911,0.010433842,-0.021021664,-0.011403819,0.034192704,0.039186455,0.027068047,-0.011417639,-0.010467432,0.011403819,-0.021021664,-0.011396911,0.034192704,0.039186455,0.027068047,-0.011417639,-0.010467432,0.011403819,-0.021021664,-0.011396911,0.034192704,0.039186455,0.027068047,-0.011417639,-0.010467432,0.011403819,-0.021021664,-0.011396911,0.034192704,0.039186455,0.027068047,-0.011417639]',  -- This is truncated, use full embedding from logs
  0.3,
  5,
  NULL,
  'Tax filing in Austria in 2025.pdf'
);

-- INSTRUCTIONS:
-- 1. Go to Supabase logs
-- 2. Find the line: "Calling RPC with params: {"query_embedding":"[...]"
-- 3. Copy the FULL embedding array (all 1536 numbers)
-- 4. Replace the embedding string above with the full one
-- 5. Run this query
-- If this returns results, the RPC works fine and the issue is elsewhere
-- If this returns 0 results, there's something wrong with the embedding format

